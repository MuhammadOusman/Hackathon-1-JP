import{j as t,h as $,i as M,k as E,g as z}from"./mui-BJon3m8q.js";import{a as r}from"./chart-BOdAsdoy.js";import{u as B,e as y}from"./redux-hkUHSYAv.js";import{f as O,h as A,v as D}from"./index-Bz2acmnO.js";import"./firebase-DhH1w7N4.js";import"./react-8-RJajJm.js";const H=()=>{const[a,p]=r.useState(""),[o,i]=r.useState({}),[d,g]=r.useState({}),[m,j]=r.useState(""),l=B(),{branches:h,loading:x}=y(e=>e.branchReducer),{products:c}=y(e=>e.productReducer);r.useEffect(()=>{l(O()),l(A())},[l]),r.useEffect(()=>{if(a){const e=h.find(n=>n.id===Number(a)||n.id===a),s={};(c||[]).forEach(n=>{s[n.name]=e&&e.inventory&&e.inventory[n.name]?e.inventory[n.name]:0}),i(s),g(s)}else i({}),g({})},[a,h,c]);const w=(e,s)=>{i({...o,[e]:Number(s)})},N=()=>{l(D({id:a,inventory:o}))},S=e=>i(s=>({...s,[e]:Math.max(0,(s[e]||0)+1)})),I=e=>i(s=>({...s,[e]:Math.max(0,(s[e]||0)-1)})),C=()=>i(d),u=r.useMemo(()=>{const e=d,s=o,n=new Set([...Object.keys(e),...Object.keys(s)]);for(const f of n)if((e[f]||0)!==(s[f]||0))return!0;return!1},[d,o]),b="w-full px-4 py-3 bg-gray-800 border border-white/10 rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",v="bg-gray-800/60 border border-white/10 rounded-xl p-5 shadow hover:shadow-xl transition-shadow duration-200",k=e=>e>0?"text-emerald-300":"text-red-300",R=r.useMemo(()=>{const e=m.trim().toLowerCase();return e?(c||[]).filter(s=>s.name.toLowerCase().includes(e)):c||[]},[c,m]);return t.jsxs("section",{className:"max-w-7xl mx-auto px-2 md:px-4",children:[t.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white mb-4",children:"Inventory Management"}),t.jsx("div",{className:`${v} mb-6`,children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 items-center",children:[t.jsxs("select",{value:a,onChange:e=>p(e.target.value),className:`${b}`,children:[t.jsx("option",{value:"",children:"Select Branch"}),h.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))]}),t.jsx("input",{type:"text",placeholder:"Search products...",value:m,onChange:e=>j(e.target.value),className:`${b} md:col-span-2`})]})}),a?t.jsx("div",{className:"space-y-4",children:R.map(e=>t.jsxs("div",{className:`${v} flex items-center justify-between gap-4`,children:[t.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"w-14 h-14 object-cover rounded"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-white text-lg font-semibold",children:e.name}),t.jsx("div",{className:`text-sm ${k(o[e.name])}`,children:o[e.name]>0?"In stock":"Out of stock"})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>I(e.name),className:"p-2 rounded-md bg-gray-700 hover:bg-gray-600 text-white","aria-label":`Decrease ${e.name}`,children:t.jsx($,{fontSize:"small"})}),t.jsx("input",{type:"number",min:0,value:o[e.name]??0,onChange:s=>w(e.name,s.target.value),className:"w-24 text-center px-3 py-2 bg-gray-900 border border-white/10 rounded-md text-white"}),t.jsx("button",{onClick:()=>S(e.name),className:"p-2 rounded-md bg-gray-700 hover:bg-gray-600 text-white","aria-label":`Increase ${e.name}`,children:t.jsx(M,{fontSize:"small"})})]})]},e.name))}):t.jsx("div",{className:"text-gray-400",children:"Select a branch to manage its inventory."}),a&&t.jsxs("div",{className:"fixed bottom-6 right-6 flex gap-3",children:[t.jsxs("button",{onClick:C,disabled:!u||x,className:"px-4 py-2 rounded-md flex items-center gap-2 bg-gray-700 hover:bg-gray-600 text-white disabled:opacity-50",title:"Reset changes",children:[t.jsx(E,{fontSize:"small"})," Reset"]}),t.jsxs("button",{onClick:N,disabled:!u||x,className:"px-4 py-2 rounded-md flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white disabled:opacity-50",title:"Save inventory",children:[t.jsx(z,{fontSize:"small"})," ",x?"Saving...":"Save Changes"]})]})]})};export{H as default};
