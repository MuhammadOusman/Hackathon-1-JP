import{j as e}from"./mui-BJon3m8q.js";import{a as l}from"./chart-BOdAsdoy.js";import{u as I}from"./redux-hkUHSYAv.js";import{g as j,y as m,d as b,s as N}from"./index-Bz2acmnO.js";import{k as C,e as E,d as k,q as O,c as M,w as x,l as P,b as H}from"./firebase-DhH1w7N4.js";import{u as D,L as q}from"./react-8-RJajJm.js";const U=()=>{const[s,g]=l.useState(""),[h,f]=l.useState(""),[c,w]=l.useState(!1),[n,p]=l.useState(!1),[B,v]=l.useState(null),i=D(),S=I(),y=async r=>{r.preventDefault();try{const t=(await C(j,s,h)).user;v(t.uid),m.success("Welcome!",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),localStorage.setItem("uid",t.uid);const o=await E(k(b,"users",t.uid));if(o.exists()){const a=o.data(),u=a.role;localStorage.setItem("role",u),localStorage.setItem("user",JSON.stringify({...a,uid:t.uid})),i(u==="admin"?"/admin-dashboard":u==="manager"?"/manager-dashboard":"/user-dashboard"),n?(localStorage.setItem("rememberEmail",s),localStorage.setItem("rememberMe","true")):(localStorage.removeItem("rememberEmail"),localStorage.removeItem("rememberMe"))}else localStorage.setItem("role","user"),localStorage.setItem("user",JSON.stringify({uid:t.uid})),i("/user-dashboard"),n?(localStorage.setItem("rememberEmail",s),localStorage.setItem("rememberMe","true")):(localStorage.removeItem("rememberEmail"),localStorage.removeItem("rememberMe"))}catch{try{const t=O(M(b,"branches"),x("managerEmail","==",s),x("password","==",h),P(1)),o=await H(t);if(o.empty)m.error("Invalid credentials",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"});else{const a={id:o.docs[0].id,...o.docs[0].data()};m.success("Manager login successful!",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),S(N({managerId:a.managerId,managerEmail:a.managerEmail,branchId:a.id,name:a.name})),localStorage.setItem("role","manager"),localStorage.setItem("user",JSON.stringify(a)),i("/manager-dashboard"),n?(localStorage.setItem("rememberEmail",s),localStorage.setItem("rememberMe","true")):(localStorage.removeItem("rememberEmail"),localStorage.removeItem("rememberMe"))}}catch{m.error("Login failed",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}}};return l.useEffect(()=>{try{const r=localStorage.getItem("rememberEmail"),d=localStorage.getItem("rememberMe")==="true";r&&g(r),p(d)}catch{}},[]),e.jsx("section",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-gray-950 via-gray-900 to-black p-4",children:e.jsx("div",{className:"w-full max-w-md rounded-2xl shadow-2xl border border-white/10 bg-gray-900/70 backdrop-blur-xl",children:e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-14 h-14 rounded-2xl shadow-lg mb-3 overflow-hidden",children:e.jsx("img",{src:"/logo.svg",alt:"FranchiseMS",className:"w-14 h-14"})}),e.jsx("h1",{className:"text-3xl font-extrabold text-white",children:"Welcome back"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Sign in to continue"})]}),e.jsxs("form",{onSubmit:y,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"sr-only",children:"Email"}),e.jsx("div",{className:"relative",children:e.jsx("input",{onChange:r=>g(r.target.value),type:"email",name:"email",id:"email",value:s,className:"w-full px-4 h-12 bg-gray-800/80 border border-white/10 rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none transition duration-200",placeholder:"your@example.com",autoComplete:"email",required:!0})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{onChange:r=>f(r.target.value),type:c?"text":"password",name:"password",id:"password",placeholder:"••••••••",className:"w-full pl-4 pr-20 h-12 bg-gray-800/80 border border-white/10 rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none transition duration-200",autoComplete:"current-password",required:!0}),e.jsx("button",{type:"button",onClick:()=>w(r=>!r),"aria-label":c?"Hide password":"Show password",className:"absolute inset-y-0 right-0 px-3 flex items-center text-purple-300 hover:text-white bg-transparent hover:bg-transparent focus:bg-transparent active:bg-transparent outline-none focus:outline-none ring-0 focus:ring-0",children:c?"Hide":"Show"})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-300 cursor-pointer select-none",children:[e.jsx("input",{type:"checkbox",checked:n,onChange:r=>p(r.target.checked),className:"h-4 w-4 accent-purple-600 cursor-pointer"}),"Remember me"]}),e.jsx(q,{to:"/signup",className:"text-xs text-purple-400 hover:text-purple-300",children:"Create account"})]})]}),e.jsx("button",{type:"submit",className:"w-full py-3 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-500 hover:to-blue-500 rounded-lg text-white text-lg font-semibold shadow-lg transition-transform duration-200 active:scale-[0.99]",children:"Sign In"})]})]})})})};export{U as default};
