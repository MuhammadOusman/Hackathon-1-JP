import{j as e,L as v}from"./mui-BJon3m8q.js";import{a as b}from"./chart-BOdAsdoy.js";import{u as y,N as x,R as f,a as m,b as S}from"./react-8-RJajJm.js";import{P as R,O as L,R as O}from"./ReviewSubmission-BS5TuGNM.js";import{u as C,e as p}from"./redux-hkUHSYAv.js";import{c as I}from"./index-Bz2acmnO.js";import"./styles-B615tSB9.js";import"./firebase-DhH1w7N4.js";const u="px-3 py-2 rounded-md text-sm font-medium transition-colors",h="bg-blue-600 text-white",g="text-gray-200 hover:text-white hover:bg-blue-500/20",U=()=>{const r=y(),l=()=>{localStorage.clear(),r("/login")};let i="User";try{const s=localStorage.getItem("user");if(s){const a=JSON.parse(s);i=a?.name||a?.fullName||a?.displayName||a?.email||"User"}}catch{}return e.jsx("nav",{className:"bg-gray-900/80 backdrop-blur text-white px-6 py-4 shadow-md border-b border-white/10",children:e.jsxs("div",{className:"max-w-6xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"/logo.svg",alt:"FranchiseMS",className:"w-8 h-8 rounded-lg"}),e.jsx("span",{className:"text-xl font-bold text-white",children:"Welcome"}),e.jsx("span",{className:"text-xl font-extrabold text-blue-400 truncate max-w-[40vw]",title:i,children:i}),e.jsx("span",{className:"text-xl","aria-hidden":!0,children:"ðŸ‘‹"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{to:"/user-dashboard/catalog",className:({isActive:s})=>`${u} ${s?h:g}`,end:!0,children:"Catalog"}),e.jsx(x,{to:"/user-dashboard/order",className:({isActive:s})=>`${u} ${s?h:g}`,children:"Order"}),e.jsx(x,{to:"/user-dashboard/review",className:({isActive:s})=>`${u} ${s?h:g}`,children:"Review"})]}),e.jsx("button",{onClick:l,"aria-label":"Logout",title:"Logout",className:"p-2 rounded-lg text-white bg-red-600 hover:bg-red-700 transition-colors duration-200",children:e.jsx(v,{fontSize:"medium"})})]})})},k=()=>e.jsxs("section",{className:"max-w-6xl mx-auto",children:[e.jsx("h2",{className:"text-3xl font-bold mb-6 text-white",children:"Product Catalog"}),e.jsx("div",{className:"bg-gray-800/60 border border-white/10 rounded-lg p-6 text-gray-100",children:e.jsx(R,{})})]}),A=()=>{const r=JSON.parse(localStorage.getItem("user")),l=C(),{orders:i}=p(t=>t.orderReducer||{orders:[]}),{products:s}=p(t=>t.productReducer||{products:[]}),a=b.useMemo(()=>{if(!i)return[];if(r?.email){const t=String(r.email).toLowerCase();return i.filter(o=>String(o.email||"").toLowerCase()===t)}return[]},[i,r?.email]),n=t=>s.find(o=>o.name===t)?.price||0;return b.useEffect(()=>{l(I())},[l]),e.jsxs("section",{className:"max-w-6xl mx-auto",children:[e.jsx("h2",{className:"text-3xl font-bold mb-6 text-white",children:"Place an Order"}),e.jsx("div",{className:"bg-gray-800/60 border border-white/10 rounded-lg p-6 text-gray-100 mb-10",children:e.jsx(L,{})}),e.jsx("h3",{className:"text-2xl font-semibold mb-4 text-white",children:"Order History"}),e.jsxs("div",{className:"bg-gray-800/60 border border-white/10 rounded-lg p-6 text-gray-100 space-y-4",children:[a.length===0&&e.jsx("p",{className:"text-gray-400",children:"No orders yet."}),a.slice().reverse().map((t,o)=>{const j=Array.isArray(t.items)&&t.items.length>0?t.items:[{product:t.product,quantity:t.quantity||1}],N=j.reduce((c,d)=>c+n(d.product)*Number(d.quantity),0),w=t.discount?Math.round(N*(1-t.discount/100)):N;return e.jsxs("div",{className:"bg-gray-900/40 border border-white/10 rounded-md p-4",children:[e.jsxs("div",{className:"font-semibold text-white mb-2",children:["Order No. ",a.length-o]}),e.jsxs("div",{className:"text-gray-300",children:["Name: ",t.name||""]}),e.jsxs("div",{className:"text-gray-300",children:["Contact: ",t.contact||""]}),e.jsx("div",{className:"text-gray-300 mt-2",children:"Items:"}),e.jsx("ul",{className:"list-disc list-inside text-gray-200",children:j.map((c,d)=>e.jsxs("li",{children:[c.product," : ",c.quantity]},d))}),e.jsxs("div",{className:"mt-2 font-bold text-white",children:["Total: Rs. ",w]}),t.discount?e.jsxs("div",{className:"text-lime-300 font-semibold",children:["Discount Applied: ",t.discount,"%"]}):null]},t.id||o)})]})]})},P=()=>{const r=JSON.parse(localStorage.getItem("user")),{branches:l}=p(s=>s.reviewsReducer||{branches:[]}),i=b.useMemo(()=>{if(!r?.branchId||!Array.isArray(l))return[];const a=l.find(n=>String(n.id)===String(r.branchId))?.reviews||[];if(r?.email){const n=String(r.email).toLowerCase();return a.filter(t=>String(t.email||"").toLowerCase()===n)}return r?.name?a.filter(n=>String(n.user||"").toLowerCase()===String(r.name).toLowerCase()):[]},[l,r?.branchId,r?.email,r?.name]);return e.jsxs("section",{className:"max-w-6xl mx-auto",children:[e.jsx("h2",{className:"text-3xl font-bold mb-6 text-white",children:"Submit a Review"}),e.jsx("div",{className:"bg-gray-800/60 border border-white/10 rounded-lg p-6 text-gray-100 mb-10",children:e.jsx(O,{})}),e.jsx("h3",{className:"text-2xl font-semibold mb-4 text-white",children:"Your Reviews"}),e.jsxs("div",{className:"bg-gray-800/60 border border-white/10 rounded-lg p-6 text-gray-100 space-y-3",children:[i.length===0&&e.jsx("p",{className:"text-gray-400",children:"No reviews yet."}),i.slice().reverse().map(s=>e.jsxs("div",{className:"bg-gray-900/40 border border-white/10 rounded-md p-4 text-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-white font-semibold",children:s.user||"You"}),s.rating?e.jsxs("span",{className:"px-2 py-0.5 rounded-md text-xs bg-gray-900 border border-white/10 text-gray-200",children:["â˜… ",s.rating]}):null]}),e.jsx("div",{children:s.review})]},s.id))]})]})},B=()=>e.jsxs("div",{className:"dashboard-container bg-gray-900 min-h-screen text-white",children:[e.jsx(U,{}),e.jsx("div",{className:"max-w-5xl mx-auto py-8",children:e.jsxs(f,{children:[e.jsx(m,{index:!0,element:e.jsx(S,{to:"catalog",replace:!0})}),e.jsx(m,{path:"catalog",element:e.jsx(k,{})}),e.jsx(m,{path:"order",element:e.jsx(A,{})}),e.jsx(m,{path:"review",element:e.jsx(P,{})})]})})]});export{B as default};
