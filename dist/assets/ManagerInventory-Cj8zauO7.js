import{j as t,h as k,i as w,k as R,g as $}from"./mui-BJon3m8q.js";import{a}from"./chart-BOdAsdoy.js";import{u as M,e as g}from"./redux-hkUHSYAv.js";import{f as O,v as z}from"./index-Bz2acmnO.js";import{c as b,i as E,d as m,b as L}from"./styles-B615tSB9.js";import"./firebase-DhH1w7N4.js";import"./react-8-RJajJm.js";const F=()=>{const[r,c]=a.useState({}),[o,p]=a.useState({}),[x,v]=a.useState(""),l=M(),{branches:h,loading:i}=g(e=>e.branchReducer),j=g(e=>e.userReducer?.currentManager?.managerId),n=h.find(e=>String(e.managerId)===String(j));a.useEffect(()=>{l(O())},[l]),a.useEffect(()=>{n&&n.inventory&&(c(n.inventory),p(n.inventory))},[n]);const y=(e,s)=>{c({...r,[e]:Number(s)})},N=()=>{n&&l(z({id:n.id,inventory:r}))},I=e=>c(s=>({...s,[e]:Math.max(0,(s[e]||0)+1)})),S=e=>c(s=>({...s,[e]:Math.max(0,(s[e]||0)-1)})),C=()=>c(o),u=a.useMemo(()=>{const e=o,s=r,d=new Set([...Object.keys(e||{}),...Object.keys(s||{})]);for(const f of d)if((e?.[f]||0)!==(s?.[f]||0))return!0;return!1},[o,r]);return i&&h.length===0?t.jsx("div",{children:"Loading branch..."}):n?t.jsxs("section",{className:"max-w-7xl mx-auto px-2 md:px-4",children:[t.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white mb-4",children:"Branch Inventory"}),t.jsx("div",{className:`${b} mb-6`,children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 items-center",children:t.jsx("input",{type:"text",placeholder:"Search products...",value:x,onChange:e=>v(e.target.value),className:`${E} md:col-span-3`})})}),t.jsx("div",{className:"space-y-4",children:Object.entries(r).filter(([e])=>e.toLowerCase().includes(x.trim().toLowerCase())).map(([e,s])=>t.jsxs("div",{className:`${b} flex items-center justify-between gap-4`,children:[t.jsx("div",{className:"flex items-center gap-4 flex-1",children:t.jsxs("div",{children:[t.jsx("div",{className:"text-white text-lg font-semibold",children:e}),t.jsx("div",{className:`text-sm ${s>0?"text-emerald-300":"text-red-300"}`,children:s>0?"In stock":"Out of stock"})]})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>S(e),className:m,"aria-label":`Decrease ${e}`,children:t.jsx(k,{fontSize:"small"})}),t.jsx("input",{type:"number",min:0,value:s??0,onChange:d=>y(e,d.target.value),className:"w-24 text-center px-3 py-2 bg-gray-900 border border-white/10 rounded-md text-white"}),t.jsx("button",{onClick:()=>I(e),className:m,"aria-label":`Increase ${e}`,children:t.jsx(w,{fontSize:"small"})})]})]},e))}),t.jsxs("div",{className:"fixed bottom-6 right-6 flex gap-3",children:[t.jsxs("button",{onClick:C,disabled:!u||i,className:m,title:"Reset changes",children:[t.jsx(R,{fontSize:"small"})," Reset"]}),t.jsxs("button",{onClick:N,disabled:!u||i,className:L,title:"Save inventory",children:[t.jsx($,{fontSize:"small"})," ",i?"Saving...":"Save Changes"]})]})]}):t.jsx("div",{children:"No branch found for this manager."})};export{F as default};
