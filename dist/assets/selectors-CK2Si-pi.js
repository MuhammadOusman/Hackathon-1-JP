import{f as s}from"./redux-hkUHSYAv.js";import{B as g,C as f,D as S}from"./index-Bz2acmnO.js";const l=g.selectAll,u=S.selectAll,d=f.selectAll,y=a=>a.userReducer?.currentManager,i=s(d,a=>{const r=new Map;return a.forEach(e=>r.set(e.name,Number(e.price||0))),r}),m=(a,r)=>{const e=(a.items||[]).reduce((n,t)=>n+(r.get(t.product)||0)*Number(t.quantity||0),0);return a.discount?e-e*a.discount/100:e},M=s([l,d,u,i],(a,r,e,n)=>{const t=e.reduce((c,o)=>c+m(o,n),0);return{totalBranches:a.length,totalProducts:r.length,totalOrders:e.length,revenue:t}}),w=s([l,u],(a,r)=>{const e=new Map;r.forEach(c=>{const o=String(c.branchId);e.set(o,(e.get(o)||0)+1)});const n=a.map(c=>c.name),t=a.map(c=>e.get(String(c.id))||0);return{labels:n,data:t}}),N=(a=10)=>s([u,i],(r,e)=>{const n=r.slice(-a),t=Math.max(0,r.length-a);return{labels:n.map((c,o)=>`#${t+o+1}`),points:n.map(c=>m(c,e))}}),k=s([u],a=>{const r=new Map;a.forEach(n=>(n.items||[]).forEach(t=>r.set(t.product,(r.get(t.product)||0)+Number(t.quantity||0))));const e=Array.from(r.entries()).sort((n,t)=>t[1]-n[1]).slice(0,5);return{labels:e.map(n=>n[0]),data:e.map(n=>n[1])}}),q=s([l],a=>{const r=[];return a.forEach(e=>{Object.entries(e.inventory||{}).filter(([,n])=>(n||0)<=5).forEach(([n,t])=>{r.push({key:`${e.id}-${n}`,branch:e.name,product:n,qty:Number(t||0)})})}),r.sort((e,n)=>e.qty-n.qty||e.branch.localeCompare(n.branch)||e.product.localeCompare(n.product))}),E=s([l],a=>a.map(r=>{const e=(r.reviews||[]).map(t=>Number(t.rating)).filter(t=>!isNaN(t));if(e.length===0)return{id:r.id,name:r.name,avg:null,count:0};const n=e.reduce((t,c)=>t+c,0)/e.length;return{id:r.id,name:r.name,avg:Math.round(n*10)/10,count:e.length}})),b=s([l,y],(a,r)=>{if(r)return a.find(e=>String(e.managerId)===String(r.managerId))}),p=a=>s([u],r=>r.filter(e=>String(e.branchId)===String(a))),O=a=>s([p(a),d,i],(r,e,n)=>{const t=r.reduce((c,o)=>c+m(o,n),0);return{totalProducts:e.length,totalOrders:r.length,revenue:t}}),P=(a,r=10)=>s([p(a),i],(e,n)=>{const t=e.slice(-r),c=Math.max(0,e.length-r);return{labels:t.map((o,h)=>`#${c+h+1}`),points:t.map(o=>m(o,n))}}),R=a=>s([p(a)],r=>{const e=new Map;r.forEach(t=>(t.items||[]).forEach(c=>e.set(c.product,(e.get(c.product)||0)+Number(c.quantity||0))));const n=Array.from(e.entries()).sort((t,c)=>c[1]-t[1]).slice(0,5);return{labels:n.map(t=>t[0]),data:n.map(t=>t[1])}}),A=a=>s([l],r=>{const e=r.find(t=>String(t.id)===String(a));return e?Object.entries(e.inventory||{}).filter(([,t])=>(t||0)<=5).map(([t,c])=>({product:t,qty:Number(c||0)})).sort((t,c)=>t.qty-c.qty||t.product.localeCompare(c.product)):[]}),C=s([b],a=>{if(!a)return null;const r=(a.reviews||[]).map(n=>Number(n.rating)).filter(n=>!isNaN(n));if(r.length===0)return null;const e=r.reduce((n,t)=>n+t,0)/r.length;return Math.round(e*10)/10});export{d as a,u as b,M as c,w as d,k as e,q as f,E as g,b as h,p as i,O as j,P as k,R as l,N as m,A as n,C as o,l as s};
